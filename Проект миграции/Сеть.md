Настройка сети в облаке
=======================

Установка сети
--------------

### Базовый сервер

Основная настройка
    
    curl https://raw.githubusercontent.com/aiskov/vm-config/master/loader.py | python
    echo '{"name":"gateway","location":"Europe/Tallinn","locale":"en_US.UTF-8","provision-scripts":["python scripts/common.py"]}' > config.json
    python provision.py

Установка VPN

    apt-get install -y openvpn easy-rsa

Добавление ключей доступа

    make-cadir /etc/openvpn/easy-rsa
    cd /etc/openvpn/easy-rsa
    
Для изменения значений по умолчанию надо изменить файл `vars`, после чего можно сгенерировать ключи:
    
    source vars
    ./clean-all
    ./build-ca

Создать ключи доступа для сервера

    ./build-key-server server

Создать ключит доступа для каждого клиента

    ./build-key client1

Сгенерировать параметр Diffie-Hellman

    ./build-dh
    
Скопировать ключи в директорию настроек openvpn

    cd /etc/openvpn/easy-rsa/keys
    cp ca.crt dh2048.pem server.crt server.key /etc/openvpn

Установка фаервола 

    apt-get install -y firehol



Настройка шифрования
--------------------



Ссылки
------
* https://www.digitalocean.com/community/tutorials/7-security-measures-to-protect-your-servers
* https://www.digitalocean.com/community/tutorials/how-to-secure-traffic-between-vps-using-openvpn
